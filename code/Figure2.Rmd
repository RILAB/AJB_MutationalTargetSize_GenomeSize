---
title: "Alpha vs. genome size"
author: "Stetter"
date: '2017'
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}

library(ggplot2)
library(cowplot)
library(viridis)
alpha_raw <- read.csv("../data/alpha_values.csv",header = T)
```


```{r,fig.width = 12,fig.height=8}

myshapes <- data.frame(name=factor(alpha_raw$genus),
                       num=as.numeric(factor(alpha_raw$genus)))
shapes <- as.numeric(factor(alpha_raw$genus))
shapes <- replace(shapes,shapes<=3,16)
shapes <- replace(shapes,shapes>=9,16)
shapes <- replace(shapes,shapes==6,16)
shapes <- replace(shapes,shapes==7,16)
shapes <- replace(shapes,shapes==4,17) # Helianthus triangle
shapes <- replace(shapes,shapes==8,18)  #Pinus dimond
shapes <- replace(shapes,shapes==5,15)  # Lactuca box
myshapes$shapes <- shapes

aplot <- ggplot(alpha_raw, aes(x=log(genome_1C_mb,10), 
                               y=derived_alpha, 
                               color=genus,size=Ne)) +
  geom_point() + 
  scale_size_continuous(range = c(4, 18))+ 
  scale_x_continuous(breaks = seq(2, 5.5, by = 0.5),
                     limits = c(2,5.5)) + 
  scale_y_continuous(breaks = seq(0, .6, by = 0.1)) + 
  theme_classic() + 
  theme(legend.position = c(0.9, 0.5),
        text = element_text(face="bold",size = 18),
        axis.ticks.length=unit(3,"mm"),
        axis.title.y = element_text(size = 24,face='bold')) + 
  labs(x = expression(log[10]("Genome size [Mb]")), 
       y = expression(alpha)) + 
  labs(colour = "Genus",size=expression(paste(N[e]))) 

aplot
ggsave("../figure/Figure2.png",plot = aplot,width = 12)
```
